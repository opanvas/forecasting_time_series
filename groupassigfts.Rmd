---
title: "Group Assignment Time Series"
author: "MBD S2.2 Group 8"
date: "2/2/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



# **THIS WILL BE CHANGED TO BE INTERACTIVE ONCE WE HAVE ALL THE TIME SERIES, IGNORE FOR NOW**
## TEST
</style>

<h3 class = 'menutop' id="Contents">
  [Contents](#Contents)
  [Introduction](#Introduction)

<div class="dropdown">
<a class="dropbtn">Data analysis</a>
<div class="dropdown-content">
  [Time series 1](#time_series_1)
  [Time series 2](#time_series_2)
  [Time series 3](#time_series_3)
  [Time series 4](#time_series_4)
</div>
</div>
  [Time series 5](#time_series_5)
  [Time series 6](#time_series_6)
  [Time series 7](#time_series_7)
</h3>
<body style = "font-family: Arial, Helvetica, sans-serif;">
<a center class="anchor" id="Introduction" style="background-color:Gainsboro; width:40%;"></a>
<center style="background-color:Gainsboro; width:40%;">Introduction</center>


> 'We are glad to present to you our first Group Assignment! We also wanted to practice R further, so we are delivering our findings in a markdown format.'

```{r, echo=F}
# Before starting, we have to install and activate some R libraries in order to use the necessary statistics and time series functions:
# basic statistics 
install.packages("fBasics")
# time series functions
install.packages("forecast")
# normality tests
install.packages("normtest")

# working with the excel tables
install.packages("xlsx")
install.packages("readxl")

library(fBasics)
library(forecast)
library(normtest)
library(tidyverse)
library(readxl)
#library(xlsx)


#clean environment
#rm(list=ls())
#File paths:
#Kiko file path
#data<-read.csv("C:/Users/usuario/Desktop/LPC/MASTERS/MBD_abril_2019/Sessions2&3sim.csv",header=TRUE,sep=";",dec=",")

#Oxana file paths
#file_path_original_data <- file.path("~","Downloads","Timeseries","Homework_1_DATA .csv")
#data<-read.csv(file_path_original_data, header=TRUE,sep=";",dec=",")
summary_table_ts_file <- file.path("~","Downloads","Timeseries","resultsfts.xlsx")
summary_table_ts_or <- read_excel(summary_table_ts_file, sheet = 1)
summary_table_ts_tr <- read_excel(summary_table_ts_file, sheet = 5)
tests_table <- read_excel(summary_table_ts_file, sheet = 2)

#Luna file path
data<-read.csv(file_path_original_data, header=TRUE,sep=";",dec=",")

# Data itself
series1=data[,1] [1:300]
series2=data[,2] [1:300]
series3=data[,3] [1:300]
series4=data[,4] [1:300]
series5=data[,5] [1:2000]
series6=data[,6] 
series7=data[,7]
```

<div id= 'summary'>
# Summary of findings 

> 'We decided to also list the tests we used together with the original and transformed data'

## Original Data 

```{r date_variant, echo=FALSE}
print(summary_table_ts_or)
```

## Transformed Data

```{r date_variant, echo=FALSE}
print(summary_table_ts_tr)
```

## Tests

> 'Additionally we wanted to list all the tests we carried out in one place in order for it to be more understandable'

```{r date_variant, echo=FALSE}
print(tests_table)
```

</div>


<div id= 'time_series_1'>
## Time Series 1
  
### Graphical Representation of Time Series and respective ACF & PACF:

```{r date_variant, echo=FALSE}
y<-series1
par(mar=c(2,2,2,2)) # to adjust graphic size
par(mfrow=c(3,1)) # plot the series, its acf and pacf together
ts.plot(y)   
acf(y)
pacf(y)
```

### Computation of basic descriptive statistics:

```{r date_variant, echo=FALSE}
mean(y)
sd(y)
skewness(y)
kurtosis(y,method=c("moment"))  
```

The series plot suggest this dataset is stationary around both mean and variance. To verify our deductions, we conducted a formal unit root test: the Augmented Dickey Fuller (ADF) with the following hypothesis:

  *Ho: the process is not stationary.(i.e. We need a unit root)*
  *H1: the process is stationary.(i.e. No differences needed)*

```{r date_variant, echo=FALSE}
ndiffs(y, alpha=0.05, test=c("adf"))
```
The ADF test indicates 0 required differences, hence enabling us to reject Ho and validate our previous inference. Furthermore, we are also capable of claiming no data transformation is needed.
When looking at both ACF & PACF function we observe that, at a 95% confidence level, past information appears unable to guide future forecasting efforts. Note that while lag 12 surpasses the confidence interval boundary, its small magnitude (approx. 0.11 ) and the lack of addition information about the dataset's time frequency (e.g is it monthly or yearly data?) make it negligible. To formally assess the series autocorrelation, we opted to realise a Box-Ljung Test with the following hypotheses:

  *Ho: Uncorrelated data*
  *H1: Correlated data*

```{r date_variant, echo=FALSE}
Box.test (y, lag = 20, type="Ljung")
```

The test p.value of 0.5 suggests that, at a 95% confindence level, we should accept the alternative hypothesis that the data is correlated and that lag 12 matters for forecasting purposes. Nevertheless, as mentioned earlier, the lag's small magnitude and our lack of additional infomation about the data made us favour the results showcased by our graphical analysis. Consequently, given the series' mean of 0.03205, we feel comfortable suggesting this series represents a white noise (WN) process. In addition, we can also conclude that no linear model would be helpful to model/predict future values of this time series (i.e. mean is the best point estimmate). Now, we will try and identify if the series' marginal distribution is normality distributed (or not) by recurring to both graphical tools and nornality tests (i.e. Shapiro and Jarque-Bera Tests). 

### Testing for Normality:

```{r date_variant, echo=FALSE}

#Graphically:

par(mfrow=c(1,1))
hist(y,prob=T,ylim=c(0,0.6),xlim=c(mean(y)-3*sd(y),mean(y)+3*sd(y)),col="red")
lines(density(y),lwd=2)
mu<-mean(y)
sigma<-sd(y)
x<-seq(mu-3*sigma,mu+3*sigma,length=100)
yy<-dnorm(x,mu,sigma)
lines(x,yy,lwd=2,col="blue")
```
According to our graphical analysis, time series 1 joint distribution seems normally distributed given the black (our series) and blue (normal distribution reference line N ~ (0,1)) overlap significantly with the exception of a small detour on the left side of the distribution around x = -2. 

```{r date_variant, echo=FALSE}

#Formal Tests:

shapiro.test(y)
jb.norm.test(y)
```
Both formal tests follow the same hypothesis structure:

  *Ho: the data is normally distributed*
  *H1: the data is not normally distributed*

While both formal tests preconised that we should reject Ho at a 95% confidence level (p.values of roughly 0.02 and 0.003 respectively), we deemed the results excessively rigid for this particular case and decided to stick with the eye test. Therefore, by infering this series joint distribution is marginally distributed, we concluded it is not only a WN but also Gaussian White Noise (GWN) and subsquently Strict White Noise (SWN) process since an uncorrelated variable whose multivariate joint distribution is Normal is forcefully indepedent and identically distributed(i.i.d). Given our latest findings, we can also infer that no non-linear model would be of help in future forecasting endeavours. 

</div id= 'time_series_2'>

### Graphical Representation of Time Series and respective ACF & PACF:

```{r date_variant, echo=FALSE}
y<-series2
par(mar=c(2,2,2,2)) # to adjust graphic size
par(mfrow=c(3,1)) # plot the series, its acf and pacf together
ts.plot(y)   
acf(y)
pacf(y)
```

### Computation of basic descriptive statistics:

```{r date_variant, echo=FALSE}
mean(y)
sd(y)
skewness(y)
kurtosis(y,method=c("moment"))  
```

The series plot suggests this dataset is not stationary around the mean (it exhbits clear sustended positive and negative fluctuations), a result hinted by the series -0.22 mean. Regarding the variance, the graph shows no clear and sustainable variance trend acrross time, hence we deemed series 2 variance stationary. To verify our deductions, we conducted a formal unit root test: the Augmented Dickey Fuller (ADF) with the following hypothesis:

  *Ho: the process is not stationary.(i.e. We need a unit root)*
  *H1: the process is stationary.(i.e. No differences needed)*

```{r date_variant, echo=FALSE}
ndiffs(y, alpha=0.05, test=c("adf"))
```

The ADF test indicates 1 difference is required for the data to become stationary in the mean, hence enabling us to accept Ho and validate our previous inference. 
When observing both ACF & PACF function we infer that, at a 95% confidence level, past information (especially lag 1) could prove to be extremely helpful to guide future forecasting efforts. To formally assess the series autocorrelation, we opted to realise a Box-Ljung Test with the following hypotheses:

  *Ho: Uncorrelated data*
  *H1: Correlated data*

```{r date_variant, echo=FALSE}
Box.test (y, lag = 20, type="Ljung")
```

The extremely small p-value reported confirmed our graphical analysis and we are now able to infer our time series is not a WN process of any kind. Consequently, we can also conclude that a linear model is needed model/predict future values of this time series. Ultimately, requiring (or not) a non-linear model to analyse this time series will remain unknown since we must first isolate the linear part of the model to make such inference.


# HEY GUYS COPYPASTE FROM HERE TO '</div>' AND ADD YOUR SERIES INFO AND THE DESIRED GRAPHS I WILL MAKE IT LOOK NICE ON THRU
#AAAAAA
<div id= 'time_series_7'>
## Time Series 7
```{r date_variant, echo=FALSE}
y<-series7
# to adjust graphic size
par(mar=c(2,2,2,2)) 

# plot the series, its acf and pacf together
par(mfrow=c(3,1))
ts.plot(y)   
acf(y)
pacf(y)

# compute basic statistics
mean(y)
sd(y)
skewness(y)
kurtosis(y,method=c("moment"))  



```
</div>
